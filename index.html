<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <!-- باقي الhead كما هو -->
</head>
<body>
    <div class="container">
        <h2>نقاط البيع - Miitoo</h2>
        
        <div id="adminAccess" style="text-align:center; margin:20px 0;">
            <button id="showAdminPanel" class="admin-btn">الدخول كمسؤول</button>
        </div>

        <table id="locationsTable">
            <!-- الجدول كما هو -->
        </table>

        <div id="managementSection" style="display:none;">
            <h3>إدارة المواقع</h3>
            <form id="accessForm">
                <!-- النموذج كما هو -->
            </form>
        </div>
    </div>

    <script>
        (function() {
            const credentials = {
                username: "miitooAdmin2025",
                password: "securePass@321"
            };

            let isAuthenticated = false;

            // زر الدخول كمسؤول
            document.getElementById('showAdminPanel').addEventListener('click', function() {
                if(validateAuth()) {
                    isAuthenticated = true;
                    toggleManagementUI(true);
                    alert("تم الدخول بنجاح!");
                }
            });

            function toggleManagementUI(show) {
                document.getElementById('managementSection').style.display = show ? 'block' : 'none';
                document.querySelectorAll('.remove').forEach(btn => {
                    btn.style.display = show ? 'inline-block' : 'none';
                });
            }

            function validateAuth() {
                const user = prompt("اسم المستخدم:");
                const pass = prompt("كلمة المرور:");
                return user === credentials.username && pass === credentials.password;
            }

            function addDeleteHandler(btn, row) {
                btn.addEventListener('click', function() {
                    if(!isAuthenticated && !validateAuth()) {
                        alert("غير مصرح بهذا الإجراء!");
                        return;
                    }
                    row.remove();
                    alert("تم الحذف بنجاح");
                });
            }

            // إضافة أزرار الحذف المخفية
            document.querySelectorAll('#locationsTable tbody tr').forEach(row => {
                const btn = document.createElement('button');
                btn.className = 'remove';
                btn.textContent = 'حذف';
                btn.style.display = 'none';
                row.querySelector('td:last-child').appendChild(btn);
                addDeleteHandler(btn, row);
            });

            // معالجة إضافة مواقع جديدة
            document.getElementById('accessForm').addEventListener('submit', function(e) {
                e.preventDefault();
                
                if(!isAuthenticated && !validateAuth()) {
                    alert("غير مصرح بهذا الإجراء!");
                    return;
                }

                // باقي كود الإضافة كما هو
            });
        })();
    </script>
</body>
</html>
